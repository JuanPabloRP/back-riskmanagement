package com.riskmanagement.back_riskmanagement.dto.model;

import com.riskmanagement.back_riskmanagement.dto.request.VulnerabilityRequest;
import com.riskmanagement.back_riskmanagement.dto.response.VulnerabilityResponse;
import com.riskmanagement.back_riskmanagement.entity.VulnerabilityEntity;
import lombok.AllArgsConstructor;
import lombok.Builder;
import lombok.Data;
import lombok.NoArgsConstructor;
import java.sql.Timestamp;

@Data
@NoArgsConstructor
@AllArgsConstructor
@Builder(toBuilder = true)
public class Vulnerability {
    private Integer id;
    private Boolean active;
    private Timestamp creationDate;
    private Timestamp modificationDate;
    private String name;
    private String description;
    private String severity;
    private String status;
    private Integer responsibleUserId;

    public static Vulnerability toModel(VulnerabilityEntity entity) {
        return Vulnerability.builder()
                .id(entity.getId())
                .active(entity.getActive())
                .creationDate(entity.getCreationDate())
                .modificationDate(entity.getModificationDate())
                .name(entity.getName())
                .description(entity.getDescription())
                .severity(entity.getSeverity())
                .responsibleUserId(entity.getResponsibleUserId())
                .build();
    }

    public static VulnerabilityEntity toEntity(Vulnerability model) {
        return VulnerabilityEntity.builder()
                .id(model.getId())
                .active(model.getActive())
                .creationDate(model.getCreationDate())
                .modificationDate(model.getModificationDate())
                .name(model.getName())
                .description(model.getDescription())
                .severity(model.getSeverity())
                .responsibleUserId(model.getResponsibleUserId())
                .build();
    }


    public static Vulnerability toModel(VulnerabilityRequest request) {
        return Vulnerability.builder()
                .name(request.getName())
                .description(request.getDescription())
                .severity(request.getSeverity())
                .build();
    }

    public static VulnerabilityResponse toResponse(Vulnerability model) {
        return VulnerabilityResponse.builder()
                .id(model.getId())
                .active(model.getActive())
                .creationDate(model.getCreationDate())
                .modificationDate(model.getModificationDate())
                .name(model.getName())
                .description(model.getDescription())
                .severity(model.getSeverity())
                .responsibleUserId(model.getResponsibleUserId())
                .build();
    }
}